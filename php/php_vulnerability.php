<?php

// --- ✅ Hardcoded secrets (Bearer) ---
$API_KEY = "sk_live_1234567890abcdefSecret";
$db_password = "root123";

// --- ✅ Insecure HTTP request (Bearer) ---
$response = file_get_contents("http://insecure.example.com/api/data");  // Insecure HTTP
echo $response;

// --- ✅ Weak hashing (Bearer) ---
function hashPassword($password) {
    return md5($password);  // Weak hashing algorithm
}

// --- ✅ Dangerous code execution (Bearer) ---
function executeCode($userInput) {
    eval($userInput);  // Code injection risk
}

// --- ✅ Insecure command execution (Bearer) ---
function deleteFile($filename) {
    exec("rm " . $filename);  // OS command injection
}

// --- ✅ Logs PII (Bearer) ---
function logUserData($data) {
    error_log("User data: " . print_r($data, true));  // Logs sensitive info
}

// --- ✅ Insecure cookie (Bearer) ---
setcookie("session", "abc123");  // No HttpOnly/Secure flags

// --- ❌ Type and logic issues (PHPStan) ---
function add($a, $b): int {
    return $a . $b;  // Concatenation instead of integer addition
}

$hashed = hashPassword("admin123");
echo "Hashed password: " . $hashed . "\n";

executeCode('echo "Executed malicious input\n";');
deleteFile("secrets.txt");
logUserData(["email" => "user@example.com", "ssn" => "123-45-6789"]);
echo add("1", 2);  // PHPStan: mixing string and int

?>
